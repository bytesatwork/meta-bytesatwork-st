From 284de3d64147cdc4a4a7a34123b89d1da0701817 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Stephan=20D=C3=BCnner?= <stephan.duenner@bytesatwork.ch>
Date: Fri, 9 Aug 2019 19:17:33 +0200
Subject: [PATCH] cmd: Add cpuinfo
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Add command for print_cpuinfo.

Signed-off-by: Stephan DÃ¼nner <stephan.duenner@bytesatwork.ch>
Signed-off-by: Rico Ganahl <rico.ganahl@bytesatwork.ch>
Signed-off-by: Guy Morand <guy.morand@bytesatwork.ch>
---
 cmd/Kconfig   |  8 ++++++++
 cmd/Makefile  |  1 +
 cmd/cpuinfo.c | 15 +++++++++++++++
 3 files changed, 24 insertions(+)
 create mode 100644 cmd/cpuinfo.c

diff --git a/cmd/Kconfig b/cmd/Kconfig
index 9d1e565dd4..5fc397e01f 100644
--- a/cmd/Kconfig
+++ b/cmd/Kconfig
@@ -161,6 +161,14 @@ config CMD_CPU
 	  internal name) and clock frequency. Other information may be
 	  available depending on the CPU driver.
 
+config CMD_CPUINFO
+	bool "cpuinfo"
+	help
+	  Print information about the CPU. This information is useful for
+	  production to identify which CPU module is being produced and write
+	  the correct information in the EEPROM.
+
+
 config CMD_LICENSE
 	bool "license"
 	select BUILD_BIN2C
diff --git a/cmd/Makefile b/cmd/Makefile
index 6e87522b62..7130fc57a5 100644
--- a/cmd/Makefile
+++ b/cmd/Makefile
@@ -46,6 +46,7 @@ obj-$(CONFIG_CMD_CONFIG) += config.o
 obj-$(CONFIG_CMD_CONITRACE) += conitrace.o
 obj-$(CONFIG_CMD_CONSOLE) += console.o
 obj-$(CONFIG_CMD_CPU) += cpu.o
+obj-$(CONFIG_CMD_CPUINFO) += cpuinfo.o
 obj-$(CONFIG_DATAFLASH_MMC_SELECT) += dataflash_mmc_mux.o
 obj-$(CONFIG_CMD_DATE) += date.o
 obj-$(CONFIG_CMD_DEMO) += demo.o
diff --git a/cmd/cpuinfo.c b/cmd/cpuinfo.c
new file mode 100644
index 0000000000..5ac47baafc
--- /dev/null
+++ b/cmd/cpuinfo.c
@@ -0,0 +1,15 @@
+// SPDX-License-Identifier: GPL-2.0+
+/*
+ * Copyright (C) 2018 bytes at work AG
+ */
+
+#include <common.h>
+#include <command.h>
+#include <init.h>
+
+static int do_cpuinfo(struct cmd_tbl *cmdtp, int flag, int argc, char * const argv[])
+{
+	return print_cpuinfo();
+}
+
+U_BOOT_CMD(cpuinfo, 1, 1, do_cpuinfo, "show cpu info", "");
-- 
2.39.2

